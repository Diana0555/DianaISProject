<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mini App | Shopping Mood Generator</title>

  <style>
    :root{
      --bg:#f7f7fb;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --accent:#2563eb;
      --accent2:#16a34a;
      --danger:#ef4444;
      --border:rgba(0,0,0,.10);
      --shadow:0 10px 30px rgba(0,0,0,.08);
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.35;
    }
    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 20px 16px 70px;
    }
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 14px 16px;
      background: rgba(255,255,255,.9);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      border-radius: 14px;
      position: sticky;
      top: 12px;
      z-index: 10;
    }
    .topbar a{
      text-decoration:none;
      color: var(--accent);
      font-weight: 900;
    }
    .pill{
      display:inline-block;
      font-size: 12px;
      font-weight: 900;
      color: #fff;
      background: var(--accent);
      padding: 6px 10px;
      border-radius: 999px;
      letter-spacing:.2px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
      margin-top: 16px;
    }
    @media (max-width: 900px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }
    h1{ margin:0 0 6px; font-size: 28px; letter-spacing:.2px; }
    h2{ margin:0 0 6px; font-size: 18px; }
    .sub{ margin:0; color: var(--muted); }

    label{
      display:block;
      font-size: 12px;
      font-weight: 900;
      color: var(--muted);
      margin: 14px 0 6px;
      letter-spacing:.4px;
      text-transform: uppercase;
    }

    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }
    @media (max-width: 520px){
      .row{ grid-template-columns: 1fr; }
    }

    select, input[type="number"]{
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 15px;
      outline: none;
      background: #fff;
    }
    select:focus, input[type="number"]:focus{
      border-color: rgba(37,99,235,.55);
      box-shadow: 0 0 0 4px rgba(37,99,235,.12);
    }

    .btns{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      margin-top: 14px;
      align-items:center;
    }
    button{
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 900;
      cursor:pointer;
      transition: transform .05s ease;
    }
    button:hover{ transform: translateY(-1px); }

    .primary{
      background: var(--accent);
      color:#fff;
      border-color: transparent;
    }
    .good{
      background: var(--accent2);
      color:#fff;
      border-color: transparent;
    }
    .danger{
      background: var(--danger);
      color:#fff;
      border-color: transparent;
    }

    .output{
      margin-top: 14px;
      border-radius: 16px;
      padding: 14px;
      background: rgba(0,0,0,.04);
      border: 1px dashed rgba(0,0,0,.15);
    }
    .outLabel{
      font-size: 12px;
      font-weight: 900;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: .6px;
      margin-bottom: 8px;
    }
    .outText{
      font-size: 16px;
      font-weight: 900;
      margin:0;
    }
    .mini{
      margin-top: 10px;
      color: var(--muted);
      font-weight: 700;
      line-height: 1.5;
    }

    .history{
      margin-top: 12px;
      border-top: 1px solid rgba(0,0,0,.08);
      padding-top: 12px;
    }
    .chip{
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      background:#fff;
      margin-top: 10px;
    }
    .chip .small{
      font-size: 12px;
      color: var(--muted);
      font-weight: 900;
      letter-spacing: .4px;
      text-transform: uppercase;
    }
    .chip .big{
      margin-top: 6px;
      font-weight: 900;
    }

    .toast{
      margin-top: 10px;
      font-size: 13px;
      font-weight: 900;
      color: var(--muted);
      min-height: 18px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <a href="scratch.html">‚Üê Back to Scratch</a>
      <span class="pill">Part 3 Mini App</span>
    </div>

    <div class="grid">
      <div class="card">
        <h1>Shopping Mood Generator</h1>
        <p class="sub">Pick your vibe + (optional) budget, then get a shopping plan: where to go, what to buy, and what to avoid.</p>

        <div class="row">
          <div>
            <label for="vibe">Vibe</label>
            <select id="vibe">
              <option value="treat">Treat Yourself</option>
              <option value="budget" selected>Budget Basics</option>
              <option value="trendy">Trendy Refresh</option>
              <option value="minimal">Minimal & Clean</option>
              <option value="gift">Gift Shopping</option>
            </select>
          </div>

          <div>
            <label for="budget">Budget (optional)</label>
            <input id="budget" type="number" min="0" placeholder="e.g., 50" />
          </div>
        </div>

        <div class="btns">
          <button class="primary" id="genBtn">Generate Mood</button>
          <button class="good" id="copyBtn">Copy</button>
          <button class="danger" id="clearBtn">Clear</button>
        </div>

        <div class="output" aria-live="polite">
          <div class="outLabel">Your shopping plan</div>
          <p class="outText" id="planTitle">Click ‚ÄúGenerate Mood‚Äù to start.</p>
          <div class="mini" id="planDetails"></div>
          <div class="toast" id="toast"></div>
        </div>
      </div>

      <div class="card">
        <h2>Recent plans</h2>
        <p class="sub">Your last few generated plans (so it‚Äôs easy to show it‚Äôs interactive).</p>

        <div class="history" id="history"></div>
      </div>
    </div>
  </div>

  <script>
    const vibeEl = document.getElementById("vibe");
    const budgetEl = document.getElementById("budget");
    const titleEl = document.getElementById("planTitle");
    const detailsEl = document.getElementById("planDetails");
    const toastEl = document.getElementById("toast");
    const historyEl = document.getElementById("history");

    const storesByVibe = {
      treat:  ["Sephora", "Nordstrom", "Ulta", "Lululemon", "a local boutique"],
      budget: ["Target", "Walmart", "Marshalls", "TJ Maxx", "Old Navy"],
      trendy: ["Zara", "H&M", "Urban Outfitters", "ASOS", "Aritzia"],
      minimal:["Uniqlo", "Everlane", "Gap", "COS", "Banana Republic Factory"],
      gift:  ["Target", "Etsy", "World Market", "Bath & Body Works", "Amazon"]
    };

    const buys = [
      "a neutral top you can re-wear",
      "a good everyday pair of shoes",
      "a cozy sweater or hoodie",
      "a simple accessory (gold hoops / watch / belt)",
      "a quality skincare staple (cleanser or moisturizer)",
      "a structured bag that matches most outfits",
      "a warm winter layer (puffer or coat)"
    ];

    const avoid = [
      "anything you can‚Äôt return",
      "duplicate items you already own",
      "super trendy pieces you won‚Äôt wear twice",
      "random checkout candy/candles",
      "buying because it‚Äôs on sale (only)",
      "items without checking your closet first"
    ];

    const moods = {
      treat:  ["Main character energy", "Luxury-lite day", "Glow-up mission"],
      budget: ["Practical & proud", "Errands but cute", "Basics upgrade"],
      trendy: ["New season refresh", "Pinterest outfit mood", "Trend test drive"],
      minimal:["Clean girl closet reset", "Capsule wardrobe moment", "Simple & expensive-looking"],
      gift:  ["Thoughtful gift mode", "Stocking-stuffer spree", "‚ÄòI nailed it‚Äô gift hunt"]
    };

    let history = [];

    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    function moneyLine(budget){
      if(!budget || budget <= 0) return "Budget: not specified.";
      if(budget < 25) return `Budget: $${budget} (go small: 1‚Äì2 items max).`;
      if(budget < 75) return `Budget: $${budget} (solid: 2‚Äì3 items).`;
      if(budget < 150) return `Budget: $${budget} (you can do a mini haul).`;
      return `Budget: $${budget} (treat yourself‚Äîstill be smart).`;
    }

    function generatePlan(){
      const vibe = vibeEl.value;
      const budget = Number(budgetEl.value);

      const mood = pick(moods[vibe]);
      const store = pick(storesByVibe[vibe]);
      const buy1 = pick(buys);
      let buy2 = pick(buys);
      while(buy2 === buy1) buy2 = pick(buys);

      const noBuy = pick(avoid);

      titleEl.textContent = `${mood} ‚Äî go to ${store}`;
      detailsEl.innerHTML =
        `<div>‚úÖ Buy: <strong>${buy1}</strong></div>` +
        `<div>‚úÖ Also buy: <strong>${buy2}</strong></div>` +
        `<div>üö´ Avoid: <strong>${noBuy}</strong></div>` +
        `<div style="margin-top:8px;">${moneyLine(budget)}</div>`;

      const record = {
        title: titleEl.textContent,
        detailText: detailsEl.textContent
      };
      history.unshift(record);
      history = history.slice(0,4);
      renderHistory();

      toastEl.textContent = "";
    }

    function renderHistory(){
      historyEl.innerHTML = "";
      history.forEach(h => {
        const div = document.createElement("div");
        div.className = "chip";
        div.innerHTML = `
          <div class="small">Plan</div>
          <div class="big">${escapeHtml(h.title)}</div>
        `;
        historyEl.appendChild(div);
      });
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    async function copyPlan(){
      const text = `${titleEl.textContent}\n${detailsEl.textContent}`.trim();
      if(!text || text.includes("Generate Mood")) return;

      try{
        await navigator.clipboard.writeText(text);
        toastEl.textContent = "Copied ‚úÖ";
      }catch(e){
        toastEl.textContent = "Copy blocked‚Äîhighlight + copy manually.";
      }
      setTimeout(()=> toastEl.textContent = "", 1400);
    }

    function clearAll(){
      budgetEl.value = "";
      titleEl.textContent = "Click ‚ÄúGenerate Mood‚Äù to start.";
      detailsEl.textContent = "";
      toastEl.textContent = "Cleared.";
      history = [];
      renderHistory();
      setTimeout(()=> toastEl.textContent = "", 1400);
    }

    document.getElementById("genBtn").addEventListener("click", generatePlan);
    document.getElementById("copyBtn").addEventListener("click", copyPlan);
    document.getElementById("clearBtn").addEventListener("click", clearAll);

    // Start with an example so the page isn't empty
    generatePlan();
  </script>
</body>
</html>
